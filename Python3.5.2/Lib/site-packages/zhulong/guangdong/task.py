from zhulong.guangdong import heyuan
from zhulong.guangdong import huizhou
from zhulong.guangdong import jiangmen
from zhulong.guangdong import jieyang
from zhulong.guangdong import meizhou

from zhulong.guangdong import zhanjiang
from zhulong.guangdong import yunfu
from zhulong.guangdong import zhaoqing
from zhulong.guangdong import zhongshan
from zhulong.guangdong import zhuhai
from lmf.dbv2 import db_command 


from os.path import join ,dirname 

import time 

def get_profile():
    path1=join(dirname(__file__),'profile')
    with open(path1,'r') as f:
        p=f.read()
    
    return p


def write_profile(txt):
    path1=join(dirname(__file__),'profile')
    with open(path1,'w') as f:
        f.write(txt)


def get_conp(txt):
    x=_conp+','+txt
    arr=x.split(',')
    return arr

_conp=get_profile()

#1
def task_heyuan(**args):
    conp=get_conp(heyuan._name_)
    heyuan.work(conp,**args)

#2
def task_huizhou(**args):
    conp=get_conp(huizhou._name_)
    huizhou.work(conp,**args)

#3
def task_jiangmen(**args):
    conp=get_conp(jiangmen._name_)
    jiangmen.work(conp,**args)

#4
def task_jieyang(**args):
    conp=get_conp(jieyang._name_)
    jieyang.work(conp,**args)

#5
def task_meizhou(**args):
    conp=get_conp(meizhou._name_)
    meizhou.work(conp,**args)

#6
def task_yunfu(**args):
    conp=get_conp(yunfu._name_)
    yunfu.work(conp,**args)

#7
def task_zhanjiang(**args):
    conp=get_conp(zhanjiang._name_)
    zhanjiang.work(conp,**args)

#8
def task_zhaoqing(**args):
    conp=get_conp(zhaoqing._name_)
    zhaoqing.work(conp,**args)


#9
def task_zhuhai(**args):
    conp=get_conp(zhuhai._name_)
    zhuhai.work(conp,**args)


#10
def task_zhongshan(**args):
    conp=get_conp(zhongshan._name_)
    zhongshan.work(conp,**args)





def task_all():

    task_heyuan()
    task_huizhou()
    task_jiangmen()
    task_jieyang()
    task_meizhou()


    task_yunfu()
    task_zhanjiang()
    task_zhaoqing()
    task_zhongshan()
    task_zhuhai()




def create_schemas():
    conp=get_conp('public')
    arr=["heyuan","huizhou","jiangmen","jieyang","meizhou","yunfu"
        ,"zhanjiang","zhaoqing","zhongshan","zhuhai"
    ]
    for diqu in arr:
        sql="create schema if not exists %s"%diqu
        db_command(sql,dbtype="postgresql",conp=conp)

    
